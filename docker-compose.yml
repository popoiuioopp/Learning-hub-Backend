# Docker Compose file Reference (https://docs.docker.com/compose/compose-file/)

version: '3'

# Define services
services:

  gameserver:
    build:
      context: ./gameserver
      dockerfile: Dockerfile
    container_name: gameserver
    restart: unless-stopped
    ports:
      - "33125:33125"
    environment:
      - PORT=33125
    depends_on: 
      - redis
    networks:
      - backend
  
  gameserver2:
    build:
      context: ./gameserver
      dockerfile: Dockerfile
    container_name: gameserver3
    restart: unless-stopped
    ports:
      - "33126:33126"
    environment:
      - PORT=33126
    depends_on: 
      - redis
    networks:
      - backend

  gameserver3:
    build:
      context: ./gameserver
      dockerfile: Dockerfile
    container_name: gameserver2
    restart: unless-stopped
    ports:
      - "33127:33127"
    environment:
      - PORT=33127
    depends_on: 
      - redis
    networks:
      - backend

  # Redis Service
  redis:
    image: "redis:alpine" 
    container_name: redis
    restart: unless-stopped
    volumes:
      - ./redis/redis.conf:/usr/local/etc/redis/redis.conf
    expose: 
      - "6379"
    # ports: 
    #   - "6379:6379"
    networks:
      - backend

volumes:
  container-volume:

networks:
  backend: